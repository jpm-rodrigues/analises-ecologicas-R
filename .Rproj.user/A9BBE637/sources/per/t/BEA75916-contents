---
title: "exercio_anova_1"
output: powerpoint_presentation
date: "2026-02-28"
---

```{r echo=TRUE}
# Chamando os pactoes e dados
## Pacotes
library(ecodados)
library(ggplot2)
## Dados
dados_anova_simples <- ecodados::anova_simples
```

---

```{r echo=TRUE}
# Inspecionando os dados 
head(dados_anova_simples)

# Análise ANOVA de um fator utilizando o pacote stats
Modelo_anova <- aov(                      # ajusta os dados à função de Análise de Variância
  Crescimento ~ Tratamento,               ## varíavel resposta ~ variável preditora
  data = dados_anova_simples              ## o "~" pode ser lido como "em função de"
  ) 
```


## Verificando as premissas

```{r echo=TRUE}
## Normalidade 
shapiro.test(residuals(Modelo_anova))

## Homogeneidade da variância
bartlett.test(Crescimento ~ Tratamento, data = dados_anova_simples)
```

## Resultados da ANOVA

```{r echo=TRUE}
anova(Modelo_anova)
```


## Diferença entre tratamentos

```{r echo=TRUE}
## Diferenças entre os tratamentos
# Teste de Tuckey's honest significant difference
TukeyHSD(Modelo_anova)
```

---
```{r echo=TRUE}
## Reorganizando a ordem que os grupos irão aparecer no gráfico
dados_anova_simples$Tratamento <- factor(dados_anova_simples$Tratamento,
                                         levels = c("Controle", "Adubo_Tradicional", "Adubo_X-2020"))

## Gráfico
ggplot(data = dados_anova_simples, 
       aes(x = Tratamento, y = Crescimento, color = Tratamento)) + 
    geom_boxplot(fill = c("darkorange", "darkorchid", "cyan4"), 
                 color = "black", show.legend = FALSE, alpha = 0.4) +
    geom_jitter(shape = 16, position = position_jitter(0.1), 
                cex = 4, alpha = 0.7) +
    scale_color_manual(values = c("darkorange", "darkorchid", "cyan4")) +
    scale_y_continuous(limits = c(0, 20), breaks = c(0, 5, 10, 15, 20)) +
    geom_text(x = 1, y = 12, label = "ab", color = "black", size = 5) +
    geom_text(x = 2, y = 17, label = "a", color = "black", size = 5) +
    geom_text(x = 3, y = 17, label = "b", color = "black", size = 5) +
    scale_x_discrete(labels = c("Sem adubo", "W", "Z")) +
    labs(x = "Adubação", y = "Crescimento Coffea arabica (cm)", size = 20) +
    theme_bw() +
    theme(legend.position = "none") 
```

